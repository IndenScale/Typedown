# 演变语义 (Evolution)

Typedown 不将数据视为静态产物，而是一个不断进化的时间线。

## 1. 线性演变 (`former`)

`former` 关键字将一个新实体状态链接到其上一个版本。

- **语法**: 在实体主体中使用 `former: "旧ID"`。
- **语义**:
  - **身份一致性**: 新实体在逻辑上代表同一个对象的不同时间点。
  - **合并策略**: 编译器执行**深度合并**。新块中出现的字段覆盖旧字段，未出现的字段从 `former` 实体继承。
  - **不可变性**: 旧 ID 依然是一个有效的、不可变的快照。

示例

````markdown
## 版本 1

```entity:Feature id=login_v1
status: planned
```

## 版本 2

```entity:Feature id=login_v2
former: "login_v1"
status: in_progress
```
````

## 2. 结构派生 (`derived_from`)

`derived_from` 关键字实现基于原型的继承。

- **语法**: `derived_from: "父ID"`。
- **语义**:
  - **身份独立性**: 新实体是一个**不同**的逻辑对象，但共享父实体的结构和数据。
  - **继承**: 类似于类继承。子实体以父实体的副本为起点并应用覆盖。

示例

````yaml
```entity:Enemy id=小怪
hp: 50
```

```entity:Enemy id=强化小怪
derived_from: "小怪"
hp: 100
```

````

## 散敛规则

- **演变分叉 (错误)**: 一个 ID 不能成为两个不同实体的 `former`。时间线不可分裂。
- **派生分叉 (允许)**: 一个 ID 可以被多个实体 `derived_from`。
