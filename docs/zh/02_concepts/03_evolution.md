---
title: 演进语义
---

# 演进语义

Typedown 不将数据视为静态产物，而是视为一个不断演化的时间线。

## 线性演进 (`former`)

`former` 关键字将新实体状态链接到其上一个版本。

### 语法

```yaml
former: [[target-id]]
```

### 约束

**必须使用全局寻址**：

| 方式 | 示例 | 状态 |
|------|------|------|
| ID 引用 | `[[user-alice-v1]]` | ✅ 允许（最常用） |
| Hash 引用 | `[[sha256:8f4b...]]` | ✅ 允许（最精确） |

### 语义规则

- **身份一致性**：新实体逻辑上代表同一对象的不同时间点
- **纯指针**：`former` 仅作为元数据链接，编译器**不执行**数据合并
- **增量原则**：新实体必须包含完整属性定义（或显式复制）
- **不可变性**：旧 ID 保持有效且不可变；被指向的实体不应再修改（Append Only）

### 示例

````typedown
## 版本 1

```entity Feature: login_v1
status: planned
```

## 版本 2

```entity Feature: login_v2
former: [[login_v1]]
status: in_progress
```
````

## 散敛规则

- **演变分叉（错误）**：一个 ID 不能成为两个不同实体的 `former`，时间线不可分裂
- **演变收敛**：多个旧版本可以合并为一个新版本，但需谨慎处理语义冲突

## 源码即真理

- **显式性**：不要期待编译器在背后进行不可见的字段注入
- **可追溯性**：通过 `former` 链条可使用 LSP 或 CLI 工具快速对比版本差异
